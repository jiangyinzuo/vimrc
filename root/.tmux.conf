# Ubuntu18.04é»˜è®¤å®‰è£…tmux2.6
# tmux2.6ä¸­ï¼Œä½¿ç”¨fzfçš„CTRL-Rå¿«æ·é”®ä¼šå¡æ­»ï¼Œè¯·æ‰‹åŠ¨è¿è¡Œ cd ~/vimrc && ./install/build_tmux.shå®‰è£…
#
# åœ¨bashä¸­ä½¿ç”¨ tmux source-file ~/.tmux.conf é‡æ–°åŠ è½½é…ç½®
# æˆ–è€…åœ¨tmuxä¸­ä½¿ç”¨ <C-b>:source-file ~/.tmux.conf é‡æ–°åŠ è½½é…ç½®

set-window-option -g mode-keys vi # tmux2.1+
setw -g mode-keys vi # tmux1.8
set -g history-limit 40000

bind-key C-e run-shell "~/vimrc/root/scripts/vim-edit-tmux-output"

# Tmuxä¸­ä¸è¦è®¾ç½®ç¯å¢ƒå˜é‡$TERMä¸ºxterm-256colorï¼Œæœ€å¥½è®¾ä¸ºscreen-256colorã€‚åŒæ—¶å®¿ä¸»æœºè®¾ç½®ä¸ºxterm-256colorã€‚è¿™æ ·ä¸»é¢˜æ‰èƒ½æ­£ç¡®æ˜¾ç¤ºã€‚
# Add truecolor support (tmux>2.2)
# https://github.com/lifepillar/vim-solarized8#troubleshooting
set-option -ga terminal-overrides ",xterm-256color:Tc"

# Default terminal is 256 colors
set -g default-terminal "screen-256color"

# sane scrolling
set -g mouse on
bind-key m setw synchronize-panes

set -g set-clipboard on
# transfer copied text to attached terminal with yank
bind-key -T copy-mode-vi y send-keys -X copy-pipe "$VIMRC_ROOT/scripts/oscyank > #{pane_tty}"

unbind -T copy-mode-vi Space
# åœ¨ copy mode ä¸­ï¼Œä½¿ç”¨ v å¼€å§‹é€‰æ‹©
bind-key -T copy-mode-vi 'v' send-keys -X begin-selection

# åœ¨ copy mode ä¸­ï¼Œä½¿ç”¨ V é€‰æ‹©æ•´è¡Œ
bind-key -T copy-mode-vi 'V' send-keys -X select-line

# https://vi.stackexchange.com/questions/16148/slow-vim-escape-from-insert-mode
# é«˜ç‰ˆæœ¬ä¸‹-gå’Œ-så¯ä»¥åˆå¹¶ï¼Œä½†å‡ºäºå…¼å®¹æ€§è€ƒè™‘ï¼Œè¿˜æ˜¯åˆ†å¼€å†™
# escape-timeè®¾ç½®ä¸º20åœ¨kiwiæœåŠ¡å™¨ä¸Šä¼šå¯¼è‡´tmuxå‡ºç°éšæœºå­—ç¬¦ä¸²ï¼Œæ•…è®¾ç½®ä¸º25
# https://github.com/microsoft/WSL/issues/5931
set -g escape-time 25
set -s escape-time 25

set -g status-interval 0  # ä¸åˆ·æ–°
set -g status-right "#(hostname -s) #(ip a | grep 'inet ' | grep -v '127.0.0.1' | awk '{print $2}' | cut -d'/' -f1 | head -n 1)"

#### tpmï¼Œè¦æ±‚tmux1.9+
#### å®‰è£…: git clone --depth=1 https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
#### Ctrl-B Iå®‰è£…æ’ä»¶

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
# è‡ªåŠ¨å¤‡ä»½tmuxä¼šè¯å¹¶æ¢å¤ï¼Œé˜²æ­¢æœåŠ¡å™¨æ–­ç”µé‡å¯åä¼šè¯ä¸¢å¤±
# 5åˆ†é’Ÿæå®štmuxå¤‡ä»½ - Kevinçš„æ–‡ç«  - çŸ¥ä¹ https://zhuanlan.zhihu.com/p/533349040
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# æ‰“å¼€tmuxåè‡ªåŠ¨restore
# set -g @continuum-restore 'on'
# è®¾ç½®è‡ªåŠ¨ä¿å­˜çš„æ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯15åˆ†é’Ÿ
# ä¸‹é¢æ„ä¸ºæ”¹ä¸º60åˆ†é’Ÿï¼Œå¦‚æœæ”¹æˆ0åˆ™åœæ­¢è‡ªåŠ¨ä¿å­˜
# set -g @continuum-save-interval '60'

# for vim
# set -g @resurrect-strategy-vim 'session'
# for neovim
# set -g @resurrect-strategy-nvim 'session'
# ä¿å­˜paneä¸­å†…å®¹
set -g @resurrect-capture-pane-contents 'on'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# ==========================================
# AI agentç›‘æ§
# ==========================================

# 1. å¿«æ·é”®å¼€å…³ï¼š
bind -N "å¼€å¯é™é»˜5ç§’æç¤ºï¼ˆå¯ä»¥ç›‘æ§Agentï¼‰" M setw monitor-silence 5
bind -N "å…³é—­é™é»˜5ç§’æç¤ºï¼ˆå…³é—­Agentç›‘æ§ï¼‰" m setw monitor-silence 0

# 2. å½»åº•å±è”½ Tmux é»˜è®¤çš„çƒ¦äººè­¦æŠ¥ (æ— æ–‡å­—ã€æ— å£°éŸ³)ï¼š
setw -g visual-silence off
set -g bell-action none
set -g silence-action none

# 3. ã€å…³é”®ä¿®å¤ã€‘å½»åº•å±è”½è‡ªå¸¦çš„é¢œè‰²åè½¬ï¼š
# æ¸…é™¤ bell å’Œ activity/silence é»˜è®¤è‡ªå¸¦çš„ reverse(åè‰²) å±æ€§
setw -g window-status-bell-style "none"
setw -g window-status-activity-style "none"

# 4. åŠ¨æ€çŠ¶æ€æ æ ¼å¼é‡å†™ (çº¯å‡€ç‰ˆï¼Œä¸å¸¦åŸç”Ÿ ~ ç¬¦å·)ï¼š
setw -g window-status-format " #I:#W#{?window_silence_flag, ğŸ¤–âœ…,}#{?window_zoomed_flag, Z,} "
setw -g window-status-current-format " #I:#W#{?window_silence_flag, ğŸ¤–âœ…,}#{?window_zoomed_flag, Z,} * "
