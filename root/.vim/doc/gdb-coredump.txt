vim:ft=help
===============================================================================
*gdb.txt*

step -> step in
next -> step over
finish -> step out
continue -> continue

gdbè°ƒè¯•.so ~

`gdb libraft.so` å¯ä»¥è°ƒè¯•åŠ¨æ€é“¾æ¥åº“ã€‚

info sharedlibrary: æŸ¥çœ‹åŠ è½½çš„åº“ã€‚

info sources: æŸ¥çœ‹æºæ–‡ä»¶ã€‚

ğŸ’ å¯ä»¥é€šè¿‡`info sources`æ£€æŸ¥ä¸€ä¸ªç¬¬ä¸‰æ–¹åŠ¨æ€åº“æ˜¯å¦åŒ…å«äº†è°ƒè¯•ä¿¡æ¯ï¼ˆ-gï¼‰ã€‚
å¦‚æœ`info sources`åªæœ‰èƒ½è¢«includeçš„å¤´æ–‡ä»¶ï¼Œ ç¼ºä¹cppæºæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªåº“æ²¡æœ‰åŒ…å«è°ƒè¯•ä¿¡æ¯ã€‚

gdbå¤šçº¿ç¨‹è°ƒè¯• ~

ä¸€æ—¦ä¸­æ–­ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½ä¼šè¢«æš‚åœã€‚
set scheduler-locking on åªæœ‰å½“å‰çº¿ç¨‹å¯ä»¥æ‰§è¡Œ
set scheduler-locking off æ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œé»˜è®¤å€¼
set scheduler-locking step ä½¿ç”¨step/nextè¿™äº›å•æ­¥å‘½ä»¤æ—¶ï¼Œåªæœ‰å½“å‰çº¿ç¨‹å¯ä»¥æ‰§è¡Œï¼›ä½¿ç”¨finish/continueå‘½ä»¤æ—¶ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥æ‰§è¡Œ
thread <ID> åˆ‡æ¢åˆ°IDçº¿ç¨‹
info threads æŸ¥çœ‹æ‰€æœ‰çº¿ç¨‹
thread apply all <command> å¯¹æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œcommand
thread apply <ID> <command> å¯¹IDçº¿ç¨‹æ‰§è¡Œcommand

gdbæŸ¥çœ‹æ ˆ: bt æ•°å­—
gdbåˆ‡æ¢æŸä¸ªæ ˆ: f[rame] æ•°å­—

-------------------------------------------------------------------------------
*gdb-time-travel*

GDBåå‘è°ƒè¯•ï¼šè®©ç¨‹åºé€†åºæ‰§è¡Œï¼Œä»£ç è°ƒè¯•åŸæ¥è¿™ä¹ˆç®€å•ï¼ä½“éªŒæ—¶å…‰æ—…è¡Œçš„å¿«æ„Ÿï¼

https://blog.csdn.net/xzh203/article/details/135820495

-------------------------------------------------------------------------------
ChatGPT

set scheduler-locking stepå’Œoffå’Œonæœ‰ä»€ä¹ˆåŒºåˆ« ~

åœ¨`gdb`ä¸­ï¼Œ`set scheduler-locking`é€‰é¡¹å¯ä»¥ç”¨æ¥æ§åˆ¶åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­å“ªäº›çº¿ç¨‹è¢«å…è®¸è¿è¡Œã€‚å®ƒæœ‰å‡ ä¸ªå¯èƒ½çš„å€¼ï¼ŒåŒ…æ‹¬`off`, `on`å’Œ`step`ã€‚ä¸‹é¢æ˜¯å®ƒä»¬çš„å·®å¼‚ï¼š

1. offï¼š
    
    * è¿™æ˜¯é»˜è®¤è®¾ç½®ã€‚
    * å½“ä¸€ä¸ªçº¿ç¨‹åœæ­¢æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä»ç„¶å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚
    * æ¢å¥è¯è¯´ï¼Œ`gdb`ä¸ä¼šé”å®šè°ƒåº¦ç¨‹åºï¼Œå…è®¸æ‰€æœ‰çº¿ç¨‹è‡ªç”±åœ°è¿è¡Œã€‚
2. onï¼š
    
    * å½“ä¸€ä¸ªçº¿ç¨‹åœæ­¢æ—¶ï¼Œæ‰€æœ‰å…¶ä»–çº¿ç¨‹ä¹Ÿä¼šè¢«è‡ªåŠ¨æš‚åœã€‚
    * è¿™æ ·ï¼Œåªæœ‰å½“å‰è¢«è°ƒè¯•çš„çº¿ç¨‹å¯ä»¥è¿è¡Œï¼Œç›´åˆ°ä½ æ˜ç¡®åœ°è®©å…¶ä»–çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚
3. stepï¼š
    
    * è¿™æ˜¯ä¸€ä¸ªä¸­é—´è®¾ç½®ã€‚
    * åªæœ‰åœ¨æ‰§è¡Œå•æ­¥å‘½ä»¤ï¼ˆå¦‚`step`, `next`ï¼‰æ—¶ï¼Œå½“å‰çº¿ç¨‹å¯ä»¥è¿è¡Œï¼Œè€Œæ‰€æœ‰å…¶ä»–çº¿ç¨‹è¢«å†»ç»“ã€‚
    * å½“ä½ ä½¿ç”¨`continue`å‘½ä»¤æ—¶ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å°†è¢«å…è®¸è¿è¡Œï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–å…¶ä»–åœæ­¢äº‹ä»¶ã€‚

é€‰æ‹©å“ªä¸ªé€‰é¡¹å–å†³äºä½ åœ¨è°ƒè¯•å¤šçº¿ç¨‹ç¨‹åºæ—¶æƒ³è¦çš„æ§åˆ¶çº§åˆ«ã€‚å¦‚æœä½ æƒ³è¦å®Œå…¨åœ°æ§åˆ¶å“ªä¸ªçº¿ç¨‹åœ¨ä»»ä½•æ—¶å€™è¿è¡Œï¼Œä½¿ç”¨`on`å¯èƒ½æ˜¯æœ€å¥½çš„ã€‚å¦‚æœä½ åªå…³å¿ƒå½“å‰çº¿ç¨‹å¹¶å¸Œæœ›åœ¨å•æ­¥æ‰§è¡Œæ—¶é˜²æ­¢å…¶ä»–çº¿ç¨‹å¹²æ‰°ï¼Œé‚£ä¹ˆ`step`æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚è€Œå¦‚æœä½ æƒ³è¦ä¸€ä¸ªæ›´è‡ªç”±çš„ç¯å¢ƒï¼Œå…¶ä¸­çº¿ç¨‹å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨è¿è¡Œï¼Œé‚£ä¹ˆ`off`å¯èƒ½æ›´åˆé€‚ã€‚

finishå‘½ä»¤åœ¨stepè®¾ç½®ä¸­ï¼Œå…¶å®ƒçº¿ç¨‹ä¼šè¢«å†»ç»“å— ~

åœ¨ `gdb` ä¸­ï¼Œå½“ `scheduler-locking` è®¾ç½®ä¸º `step` æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¸»è¦åœ¨ä½¿ç”¨åƒ `step` å’Œ `next` è¿™æ ·çš„å•æ­¥å‘½ä»¤æ—¶è¢«å†»ç»“ã€‚ä½†å¯¹äº `finish` å‘½ä»¤ï¼Œæƒ…å†µç•¥æœ‰ä¸åŒã€‚

`finish` å‘½ä»¤çš„ä½œç”¨æ˜¯ç»§ç»­æ‰§è¡Œå½“å‰çº¿ç¨‹ï¼Œç›´åˆ°ä»å½“å‰å‡½æ•°è¿”å›ã€‚åœ¨æ‰§è¡Œè¿™ä¸€å‘½ä»¤æ—¶ï¼Œç”±äºå®ƒä¸æ˜¯çœŸæ­£çš„å•æ­¥å‘½ä»¤ï¼Œè€Œæ˜¯ä¸€ä¸ªä½¿çº¿ç¨‹ç»§ç»­è¿è¡Œçš„å‘½ä»¤ï¼ˆåªæ˜¯è¿è¡Œåˆ°ç‰¹å®šçš„ä½ç½®ï¼Œå³å‡½æ•°è¿”å›ç‚¹ï¼‰ï¼Œå› æ­¤ï¼Œå½“ `scheduler-locking` è®¾ç½®ä¸º `step` æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¸ä¼šè¢«å†»ç»“ï¼Œå®ƒä»¬ä¹Ÿä¼šè¢«å…è®¸è¿è¡Œã€‚

æ‰€ä»¥ï¼Œç®€çŸ­çš„å›ç­”æ˜¯ï¼šä½¿ç”¨ `finish` å‘½ä»¤æ—¶ï¼Œå³ä½¿ `scheduler-locking` è¢«è®¾ç½®ä¸º `step`ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«å†»ç»“ã€‚

å“ªäº›å‘½ä»¤æ˜¯å•æ­¥å‘½ä»¤ï¼Œä¸ºä»€ä¹ˆ ~

åœ¨`gdb`ä¸­ï¼Œå•æ­¥å‘½ä»¤å…è®¸å¼€å‘è€…åœ¨ä»£ç ä¸­ä¸€æ­¥æ­¥åœ°å‰è¿›ï¼ŒåŒæ—¶è§‚å¯Ÿæ¯ä¸€æ­¥çš„æ•ˆæœã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªå¸¸ç”¨çš„å•æ­¥å‘½ä»¤ï¼š

1. **step** (`s`):
    * æ‰§è¡Œç¨‹åºç›´åˆ°åˆ°è¾¾ä¸€ä¸ªæ–°çš„æºä»£ç è¡Œã€‚
    * å¦‚æœå½“å‰è¡Œè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™è¿›å…¥è¯¥å‡½æ•°å¹¶åœåœ¨ç¬¬ä¸€è¡Œã€‚
2. **next** (`n`):
    * ä¸`step`ç±»ä¼¼ï¼Œå®ƒæ‰§è¡Œç¨‹åºç›´åˆ°åˆ°è¾¾ä¸€ä¸ªæ–°çš„æºä»£ç è¡Œã€‚
    * ä½†æ˜¯ï¼Œå¦‚æœå½“å‰è¡Œæœ‰ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œ`next`å‘½ä»¤å°†æ‰§è¡Œæ•´ä¸ªå‡½æ•°ï¼Œç„¶ååœåœ¨è°ƒç”¨è¯¥å‡½æ•°çš„ä¸‹ä¸€è¡Œã€‚
3. **stepi** (`si`):
    * æŒ‰å•ä¸ªæœºå™¨æŒ‡ä»¤æ‰§è¡Œç¨‹åºã€‚
    * å¦‚æœå½“å‰æŒ‡ä»¤æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œ`stepi`ä¼šè¿›å…¥è¯¥å‡½æ•°ã€‚
4. **nexti** (`ni`):
    * ä¸`stepi`ç±»ä¼¼ï¼Œå®ƒæŒ‰å•ä¸ªæœºå™¨æŒ‡ä»¤æ‰§è¡Œç¨‹åºã€‚
    * ä½†æ˜¯ï¼Œå¦‚æœå½“å‰æŒ‡ä»¤æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œ`nexti`ä¼šæ‰§è¡Œæ•´ä¸ªå‡½æ•°ï¼Œç„¶ååœåœ¨è°ƒç”¨è¯¥å‡½æ•°çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚

ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å•æ­¥å‘½ä»¤ï¼Ÿ ~

å•æ­¥å‘½ä»¤åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å…è®¸å¼€å‘è€…ç»†ç²’åº¦åœ°æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œï¼ŒåŒæ—¶è§‚å¯Ÿç¨‹åºçŠ¶æ€çš„æ¯ä¸€ä¸ªå°å˜åŒ–ã€‚è¿™æ ·ï¼Œå¼€å‘è€…å¯ä»¥æ›´å®¹æ˜“åœ°æ‰¾åˆ°é”™è¯¯ï¼Œç†è§£ä»£ç çš„è¡Œä¸ºï¼Œä»¥åŠè¯Šæ–­é—®é¢˜ã€‚

ä¾‹å¦‚ï¼Œä½¿ç”¨`step`ï¼Œå¼€å‘è€…å¯ä»¥æ·±å…¥å‡½æ•°è°ƒç”¨ï¼Œçœ‹çœ‹å‡½æ•°å†…éƒ¨å‘ç”Ÿäº†ä»€ä¹ˆï¼Œè€Œä½¿ç”¨`next`ï¼Œå¼€å‘è€…å¯ä»¥è·³è¿‡å¯¹å·²çŸ¥å‡½æ•°çš„è°ƒç”¨ï¼Œä¸“æ³¨äºå½“å‰æ­£åœ¨è°ƒè¯•çš„ä»£ç ã€‚è¿™ä¸ºå¼€å‘è€…æä¾›äº†å¤šç§æ–¹å¼æ¥é€¼è¿‘å’Œè¯Šæ–­é—®é¢˜ã€‚

finishå’Œcontinueä¸ºä»€ä¹ˆä¸æ˜¯å•æ­¥å‘½ä»¤ ~

åœ¨`gdb`ä¸­ï¼Œ`finish`å’Œ`continue`å‘½ä»¤ä¸è¢«è§†ä¸ºå•æ­¥å‘½ä»¤ï¼Œä¸»è¦åŸºäºå®ƒä»¬çš„æ“ä½œå’Œç›®çš„ã€‚

1. **finish**ï¼š
    
    * å½“ä½ åœ¨æŸä¸ªå‡½æ•°å†…éƒ¨åœæ­¢æ—¶ï¼Œ`finish`å‘½ä»¤å…è®¸ä½ æ‰§è¡Œå½“å‰å‡½æ•°ç›´åˆ°å®ƒè¿”å›ï¼Œç„¶åæš‚åœæ‰§è¡Œã€‚
    * `finish`çš„ç›®çš„æ˜¯â€œè·³å‡ºâ€å½“å‰å‡½æ•°ï¼Œè€Œä¸æ˜¯é€è¡Œæ‰§è¡Œå®ƒã€‚
2. **continue** (`c`):
    
    * `continue`å‘½ä»¤ç®€å•åœ°ç»§ç»­æ‰§è¡Œç¨‹åºï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ã€è§‚å¯Ÿç‚¹æˆ–å…¶ä»–åœæ­¢æ¡ä»¶ã€‚
    * å®ƒçš„ç›®çš„æ˜¯ä»å½“å‰åœæ­¢çš„ä½ç½®ç»§ç»­æ‰§è¡Œï¼Œè€Œä¸æ˜¯å•æ­¥å‰è¿›ã€‚

å•æ­¥å‘½ä»¤çš„ç›®çš„æ˜¯å…è®¸å¼€å‘è€…é€è¡Œï¼ˆæˆ–é€æŒ‡ä»¤ï¼‰æ‰§è¡Œç¨‹åºï¼Œè¿™æ ·ä»–ä»¬å¯ä»¥å¯†åˆ‡åœ°è§‚å¯Ÿä»£ç çš„è¡Œä¸ºå’Œç¨‹åºçŠ¶æ€çš„å˜åŒ–ã€‚è€Œ`finish`å’Œ`continue`çš„ç›®çš„æ›´å¤šåœ°æ˜¯åœ¨ä»£ç ä¸­ç§»åŠ¨ï¼Œè€Œä¸æ˜¯å¯†åˆ‡åœ°è§‚å¯Ÿæ¯ä¸€è¡Œæˆ–æ¯ä¸€æ¡æŒ‡ä»¤çš„æ•ˆæœã€‚

æ‰€ä»¥ï¼Œè™½ç„¶`finish`å’Œ`continue`éƒ½æ˜¯æ§åˆ¶ç¨‹åºæ‰§è¡Œçš„å‘½ä»¤ï¼Œä½†å®ƒä»¬çš„ç›®çš„å’Œæ“ä½œæ–¹å¼ä¸å•æ­¥å‘½ä»¤ä¸åŒï¼Œå› æ­¤å®ƒä»¬ä¸è¢«è§†ä¸ºå•æ­¥å‘½ä»¤ã€‚

-------------------------------------------------------------------------------
*coredump*

*gdbè°ƒè¯•coredump*

>
	gdb <executable> <coredump_file>
<

ä¸´æ—¶ä¼šè¯ç”Ÿæˆcoredump ~

>
	# è®¾ç½® coredump æ–‡ä»¶å¤§å°æ— é™åˆ¶
	ulimit -c unlimited

	# è®¾ç½®coredumpæ–‡ä»¶å
	echo '/tmp/core.%e.%p.%t' | sudo tee /proc/sys/kernel/core_pattern
<

æ°¸ä¹…è®¾ç½®coredumpæ–‡ä»¶ ~

-------------------------------------------------------------------------------
*debug-adapter*

vimspectorä¸­è°ƒè¯•å¤šçº¿ç¨‹C++ç¨‹åºã€‚

ç›´æ¥æ‰§è¡Œgdbå‘½ä»¤: -exec command

For the C++ (GDB/LLDB) debugging environment, you can execute GDB, LLDB and LLDB-MI commands directly through the debug console with the -exec command, but be careful, executing commands directly in the debug console is untested and might crash VS Code in some cases.

-------------------------------------------------------------------------------
*lldb*  https://lldb.llvm.org/

å¯èƒ½æ¯”gdbæ›´å¥½ç”¨çš„è°ƒè¯•å™¨ã€‚

